var config = {
    "consumerKey": process.env.TWITTER_CONSUMER_KEY,
    "consumerSecret": process.env.TWITTER_CONSUMER_SECRET,
    "accessToken": process.env.TWITTER_ACCESS_TOKEN_KEY,
    "accessTokenSecret": process.env.TWITTER_ACCESS_TOKEN_SECRET,
    "callBackUrl": "https://wallet.primecore.io/auth_twitter"
}

const request = require('request');
const OAuth   = require('oauth-1.0a');
const crypto  = require('crypto');

// Initialize
const oauth = OAuth({
    consumer: {
        key: config.consumerKey,
        secret: config.consumerSecret
    },
    signature_method: 'HMAC-SHA1',
    hash_function(base_string, key) {
        return crypto.createHmac('sha1', key).update(base_string).digest('base64');
    }
});


// Note: The token is optional for some requests
const token = {
    key: config.accessToken,
    secret: config.accessTokenSecret
};


function getFriends(id) {
    const request_data = {
        url: 'https://api.twitter.com/1.1/followers/list.json?user_id=' + id,
        method: 'GET',
        data: { user_id: id }
    };
    let header = oauth.authorize(request_data, token);
    header.oauth_signature =encodeURIComponent(header.oauth_signature);

    console.error("________1_______")
    console.error(request_data, token)
    console.error(oauth.authorize(request_data, token))
    console.error(header)
    console.log(oauth.toHeader(header));
    console.error("________1_______")


    request({
        url: request_data.url,
        method: request_data.method,
        headers: oauth.toHeader(header)
    }, function(error, response, body) {
        console.error("_______________")
        console.error(error)
        console.log(body);
        console.error("_______________")

        // Process your data here
    });
}


module.exports = {getFriends}
